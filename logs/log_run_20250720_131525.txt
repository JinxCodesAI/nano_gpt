================================================================================
Training run started at 2025-07-20 13:15:25
================================================================================
Configuration:
----------------------------------------
always_save_checkpoint: True
attn_lora_rank: 48
attn_lora_rank_divisor: 16
backend: nccl
batch_size: 32
batch_size_multiplier: 1.0
beta1: 0.9
beta2: 0.95
bias: False
block_size: 1024
compile: True
dataset: fineweb10B
decay_lr: True
device: cuda
dropout: 0.0
dtype: bfloat16
embedding_mode: lora
embedding_rank: 48
eval_interval: 100
eval_interval_multiplier: 1.0
eval_iters: 10
eval_iters_multiplier: 1.0
eval_only: False
file_logging: True
grad_accum_multiplier: 1.0
grad_clip: 1.0
gradient_accumulation_steps: 2
init_from: scratch
learning_rate: 0.001
log_dir: logs
log_interval: 10
lora_alpha: 1.0
lora_alpha_multiplier: 1.0
lr_decay_iters: 600000
lr_multiplier: 10
max_iters: 600000
min_lr: 6e-05
n_embd: 768
n_head: 12
n_hidden_divisor: 4
n_layer: 12
n_layer_divisor: 4
out_dir: out
rotary_base: 10000.0
rotary_max_position_embeddings: 2048
use_rotary_embeddings: True
vocab_lora_rank_divisor: 16
wandb_log: True
wandb_project: owt
wandb_run_name: gpt2
warmup_iters: 200
warmup_iters_multiplier: 1.0
weight_decay: 0.1
----------------------------------------
[2025-07-20 13:15:35] step 0: train loss 10.9677, val loss 10.9694
[2025-07-20 13:16:35] step 100: train loss 8.5815, val loss 8.5840
[2025-07-20 13:17:36] step 200: train loss 8.0080, val loss 8.0112
[2025-07-20 13:18:38] step 300: train loss 7.7247, val loss 7.6872
[2025-07-20 13:18:38] OPERATION_START: merge_lora_weights first burn | iter=300 | value=None | trigger=Loss threshold | val_loss=7.6872 | trigger_loss=8.0000 | max_wait=500
[2025-07-20 13:18:38] OPERATION_SUCCESS: merge_lora_weights | iter=300 | status=merged
[2025-07-20 13:18:38] OPERATION_START: change_lr  | iter=300 | value=0.7 | trigger=Loss threshold | val_loss=7.6872 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:18:38] OPERATION_SUCCESS: change_lr | iter=300 | old=10 | new=7.0
[2025-07-20 13:18:38] OPERATION_START: reset_lr_schedule  | iter=300 | value=None | trigger=Loss threshold | val_loss=7.6872 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:18:38] OPERATION_SUCCESS: reset_lr_schedule | iter=300 | old=0 | new=300
[2025-07-20 13:19:39] step 400: train loss 7.5153, val loss 7.4398
[2025-07-20 13:20:40] step 500: train loss 7.3610, val loss 7.3414
[2025-07-20 13:20:41] OPERATION_START: merge_lora_weights second burn | iter=500 | value=None | trigger=Loss threshold | val_loss=7.3414 | trigger_loss=7.4000 | max_wait=300
[2025-07-20 13:20:41] OPERATION_SUCCESS: merge_lora_weights | iter=500 | status=merged
[2025-07-20 13:20:41] OPERATION_START: change_lr  | iter=500 | value=0.2 | trigger=Loss threshold | val_loss=7.3414 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:20:41] OPERATION_SUCCESS: change_lr | iter=500 | old=7.0 | new=1.4000000000000001
[2025-07-20 13:20:41] OPERATION_START: change_warmup_iters  | iter=500 | value=5 | trigger=Loss threshold | val_loss=7.3414 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:20:41] OPERATION_SUCCESS: change_warmup_iters | iter=500 | old=1.0 | new=5.0
[2025-07-20 13:20:41] OPERATION_START: reset_lr_schedule  | iter=500 | value=None | trigger=Loss threshold | val_loss=7.3414 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:20:41] OPERATION_SUCCESS: reset_lr_schedule | iter=500 | old=300 | new=500
[2025-07-20 13:20:41] OPERATION_START: change_batch_size  | iter=500 | value=0.5 | trigger=Loss threshold | val_loss=7.3414 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:20:41] OPERATION_SUCCESS: change_batch_size | iter=500 | old=32 | new=16
[2025-07-20 13:20:41] OPERATION_START: change_grad_accum  | iter=500 | value=2.0 | trigger=Loss threshold | val_loss=7.3414 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:20:41] OPERATION_SUCCESS: change_grad_accum | iter=500 | old=2 | new=4
[2025-07-20 13:20:41] OPERATION_START: change_lr  | iter=500 | value=0.7 | trigger=Loss threshold | val_loss=7.3414 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:20:41] OPERATION_SUCCESS: change_lr | iter=500 | old=1.4000000000000001 | new=0.98
[2025-07-20 13:20:41] OPERATION_START: reset_lr_schedule  | iter=500 | value=None | trigger=Loss threshold | val_loss=7.3414 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:20:41] OPERATION_SUCCESS: reset_lr_schedule | iter=500 | old=500 | new=500
[2025-07-20 13:20:41] OPERATION_START: stack_layers first resize | iter=500 | value=2 | trigger=Loss threshold | val_loss=7.3414 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:20:41] OPERATION_SUCCESS: stack_layers | iter=500 | old_divisor=4 | new_divisor=2.0 | new_layers=6
[2025-07-20 13:20:45] OPERATION_REEVALUATION: stack_layers | iter=500 | old_val_loss=7.3414 | new_val_loss=7.9932 | change=+0.6518
[2025-07-20 13:20:45] step 500: train loss 7.9361, val loss 7.9932
[2025-07-20 13:22:14] step 600: train loss 7.4012, val loss 7.3638
[2025-07-20 13:23:33] step 700: train loss 7.3435, val loss 7.3149
[2025-07-20 13:24:52] step 800: train loss 7.2351, val loss 7.2012
[2025-07-20 13:26:12] step 900: train loss 7.1377, val loss 7.2288
[2025-07-20 13:27:31] step 1000: train loss 7.2359, val loss 7.1869
[2025-07-20 13:28:50] step 1100: train loss 7.0550, val loss 7.1511
[2025-07-20 13:30:10] step 1200: train loss 7.0885, val loss 7.0564
[2025-07-20 13:30:11] OPERATION_START: merge_lora_weights third burn | iter=1200 | value=None | trigger=Loss threshold | val_loss=7.0564 | trigger_loss=7.1000 | max_wait=700
[2025-07-20 13:30:11] OPERATION_SUCCESS: merge_lora_weights | iter=1200 | status=merged
[2025-07-20 13:30:11] OPERATION_START: change_batch_size  | iter=1200 | value=0.5 | trigger=Loss threshold | val_loss=7.0564 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:30:11] OPERATION_SUCCESS: change_batch_size | iter=1200 | old=16 | new=8
[2025-07-20 13:30:11] OPERATION_START: change_grad_accum  | iter=1200 | value=2.0 | trigger=Loss threshold | val_loss=7.0564 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:30:11] OPERATION_SUCCESS: change_grad_accum | iter=1200 | old=4 | new=8
[2025-07-20 13:30:11] OPERATION_START: widen_mlp  | iter=1200 | value=2 | trigger=Loss threshold | val_loss=7.0564 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:30:11] OPERATION_SUCCESS: widen_mlp | iter=1200 | old_divisor=4 | new_divisor=2.0 | new_hidden=1536
[2025-07-20 13:30:14] OPERATION_REEVALUATION: widen_mlp | iter=1200 | old_val_loss=7.0564 | new_val_loss=7.0378 | change=-0.0187
[2025-07-20 13:30:14] step 1200: train loss 7.1035, val loss 7.0378
[2025-07-20 13:31:48] step 1300: train loss 7.0142, val loss 7.0641
[2025-07-20 13:31:49] OPERATION_START: change_lr  | iter=1300 | value=0.7 | trigger=Loss threshold | val_loss=7.0641 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:31:49] OPERATION_SUCCESS: change_lr | iter=1300 | old=0.98 | new=0.6859999999999999
[2025-07-20 13:31:49] OPERATION_START: reset_lr_schedule  | iter=1300 | value=None | trigger=Loss threshold | val_loss=7.0641 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:31:49] OPERATION_SUCCESS: reset_lr_schedule | iter=1300 | old=500 | new=1300
[2025-07-20 13:31:49] OPERATION_START: stack_layers third resize | iter=1300 | value=2 | trigger=Loss threshold | val_loss=7.0641 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:31:49] OPERATION_SUCCESS: stack_layers | iter=1300 | old_divisor=2.0 | new_divisor=1.0 | new_layers=12
[2025-07-20 13:32:12] OPERATION_REEVALUATION: stack_layers | iter=1300 | old_val_loss=7.0641 | new_val_loss=7.3828 | change=+0.3187
[2025-07-20 13:32:12] step 1300: train loss 7.5528, val loss 7.3828
