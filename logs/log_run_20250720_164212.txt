================================================================================
Training run started at 2025-07-20 16:42:12
================================================================================
Configuration:
----------------------------------------
always_save_checkpoint: True
attn_lora_rank: 48
attn_lora_rank_divisor: 16
backend: nccl
batch_size: 32
batch_size_multiplier: 1.0
beta1: 0.9
beta2: 0.95
bias: False
block_size: 1024
compile: True
dataset: fineweb10B
decay_lr: True
device: cuda
dropout: 0.0
dtype: bfloat16
embedding_mode: lora
embedding_rank: 48
eval_interval: 100
eval_interval_multiplier: 1.0
eval_iters: 10
eval_iters_multiplier: 1.0
eval_only: False
file_logging: True
grad_accum_multiplier: 1.0
grad_clip: 1.0
gradient_accumulation_steps: 2
init_from: scratch
learning_rate: 0.001
log_dir: logs
log_interval: 10
lora_alpha: 1.0
lora_alpha_multiplier: 1.0
lr_decay_iters: 600000
lr_multiplier: 10
max_iters: 600000
min_lr: 6e-05
n_embd: 768
n_head: 12
n_hidden_divisor: 4
n_layer: 12
n_layer_divisor: 4
out_dir: out
rotary_base: 10000.0
rotary_max_position_embeddings: 2048
use_rotary_embeddings: True
vocab_lora_rank_divisor: 16
wandb_log: True
wandb_project: owt
wandb_run_name: gpt2
warmup_iters: 200
warmup_iters_multiplier: 1.0
weight_decay: 0.1
----------------------------------------
[2025-07-20 16:42:26] step 0: train loss 10.9683, val loss 10.9694
[2025-07-20 16:43:29] step 100: train loss 8.5642, val loss 8.5753
[2025-07-20 16:44:30] step 200: train loss 7.9645, val loss 7.9978
[2025-07-20 16:44:31] OPERATION_START: merge_lora_weights first burn | iter=200 | value=None | trigger=Loss threshold | val_loss=7.9978 | trigger_loss=8.0000 | max_wait=1500
[2025-07-20 16:44:31] OPERATION_SUCCESS: merge_lora_weights | iter=200 | status=merged
[2025-07-20 16:44:31] OPERATION_START: change_lr  | iter=200 | value=0.3 | trigger=Loss threshold | val_loss=7.9978 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 16:44:31] OPERATION_SUCCESS: change_lr | iter=200 | old=10 | new=3.0
[2025-07-20 16:44:31] OPERATION_START: reset_lr_schedule  | iter=200 | value=None | trigger=Loss threshold | val_loss=7.9978 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 16:44:31] OPERATION_SUCCESS: reset_lr_schedule | iter=200 | old=0 | new=200
[2025-07-20 16:45:33] step 300: train loss 7.8596, val loss 7.8562
[2025-07-20 16:46:35] step 400: train loss 7.5865, val loss 7.5946
[2025-07-20 16:47:37] step 500: train loss 7.5082, val loss 7.4592
[2025-07-20 16:48:40] step 600: train loss 7.3464, val loss 7.3637
[2025-07-20 16:49:42] step 700: train loss 7.2642, val loss 7.3243
[2025-07-20 16:50:45] step 800: train loss 7.1622, val loss 7.2267
[2025-07-20 16:51:47] step 900: train loss 7.0964, val loss 7.1433
[2025-07-20 16:52:49] step 1000: train loss 7.0592, val loss 7.0658
[2025-07-20 16:53:52] step 1100: train loss 7.0154, val loss 7.0372
[2025-07-20 16:54:54] step 1200: train loss 6.9975, val loss 6.9451
[2025-07-20 16:55:57] step 1300: train loss 6.9008, val loss 6.9612
[2025-07-20 16:56:59] step 1400: train loss 6.8827, val loss 6.9096
[2025-07-20 16:58:01] step 1500: train loss 6.9131, val loss 6.8728
[2025-07-20 16:59:03] step 1600: train loss 6.7855, val loss 6.8026
[2025-07-20 17:00:06] step 1700: train loss 6.7863, val loss 6.7978
[2025-07-20 17:00:06] OPERATION_START: merge_lora_weights first burn | iter=1700 | value=None | trigger=Timeout | val_loss=6.7978 | trigger_loss=6.7000 | max_wait=1500
[2025-07-20 17:00:06] OPERATION_SUCCESS: merge_lora_weights | iter=1700 | status=merged
[2025-07-20 17:00:06] OPERATION_START: change_lr  | iter=1700 | value=0.5 | trigger=Loss threshold | val_loss=6.7978 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 17:00:06] OPERATION_SUCCESS: change_lr | iter=1700 | old=3.0 | new=1.5
[2025-07-20 17:00:06] OPERATION_START: reset_lr_schedule  | iter=1700 | value=None | trigger=Loss threshold | val_loss=6.7978 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 17:00:06] OPERATION_SUCCESS: reset_lr_schedule | iter=1700 | old=200 | new=1700
[2025-07-20 17:00:06] OPERATION_START: change_warmup_iters  | iter=1700 | value=2 | trigger=Loss threshold | val_loss=6.7978 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 17:00:06] OPERATION_SUCCESS: change_warmup_iters | iter=1700 | old=1.0 | new=2.0
[2025-07-20 17:00:06] OPERATION_START: stack_layers first burn | iter=1700 | value=2 | trigger=Loss threshold | val_loss=6.7978 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 17:00:06] OPERATION_SUCCESS: stack_layers | iter=1700 | old_divisor=4 | new_divisor=2.0 | new_layers=6
[2025-07-20 17:00:11] OPERATION_REEVALUATION: stack_layers | iter=1700 | old_val_loss=6.7978 | new_val_loss=9.1340 | change=+2.3362
[2025-07-20 17:00:11] step 1700: train loss 9.2009, val loss 9.1340
