================================================================================
Training run started at 2025-07-20 13:34:56
================================================================================
Configuration:
----------------------------------------
always_save_checkpoint: True
attn_lora_rank: 48
attn_lora_rank_divisor: 16
backend: nccl
batch_size: 32
batch_size_multiplier: 1.0
beta1: 0.9
beta2: 0.95
bias: False
block_size: 1024
compile: True
dataset: fineweb10B
decay_lr: True
device: cuda
dropout: 0.0
dtype: bfloat16
embedding_mode: lora
embedding_rank: 48
eval_interval: 100
eval_interval_multiplier: 1.0
eval_iters: 10
eval_iters_multiplier: 1.0
eval_only: False
file_logging: True
grad_accum_multiplier: 1.0
grad_clip: 1.0
gradient_accumulation_steps: 2
init_from: scratch
learning_rate: 0.001
log_dir: logs
log_interval: 10
lora_alpha: 1.0
lora_alpha_multiplier: 1.0
lr_decay_iters: 600000
lr_multiplier: 10
max_iters: 600000
min_lr: 6e-05
n_embd: 768
n_head: 12
n_hidden_divisor: 4
n_layer: 12
n_layer_divisor: 4
out_dir: out
rotary_base: 10000.0
rotary_max_position_embeddings: 2048
use_rotary_embeddings: True
vocab_lora_rank_divisor: 16
wandb_log: True
wandb_project: owt
wandb_run_name: gpt2
warmup_iters: 200
warmup_iters_multiplier: 1.0
weight_decay: 0.1
----------------------------------------
[2025-07-20 13:35:06] step 0: train loss 10.9660, val loss 10.9694
[2025-07-20 13:36:07] step 100: train loss 8.5569, val loss 8.5812
[2025-07-20 13:37:08] step 200: train loss 7.9600, val loss 7.9969
[2025-07-20 13:37:09] OPERATION_START: merge_lora_weights first burn | iter=200 | value=None | trigger=Loss threshold | val_loss=7.9969 | trigger_loss=8.0000 | max_wait=500
[2025-07-20 13:37:09] OPERATION_SUCCESS: merge_lora_weights | iter=200 | status=merged
[2025-07-20 13:37:09] OPERATION_START: change_lr  | iter=200 | value=0.7 | trigger=Loss threshold | val_loss=7.9969 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:37:09] OPERATION_SUCCESS: change_lr | iter=200 | old=10 | new=7.0
[2025-07-20 13:37:09] OPERATION_START: reset_lr_schedule  | iter=200 | value=None | trigger=Loss threshold | val_loss=7.9969 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:37:09] OPERATION_SUCCESS: reset_lr_schedule | iter=200 | old=0 | new=200
[2025-07-20 13:38:09] step 300: train loss 7.7868, val loss 7.7859
[2025-07-20 13:39:11] step 400: train loss 7.6348, val loss 7.5478
[2025-07-20 13:40:12] step 500: train loss 7.3601, val loss 7.4033
[2025-07-20 13:40:12] OPERATION_START: merge_lora_weights second burn | iter=500 | value=None | trigger=Timeout | val_loss=7.4033 | trigger_loss=7.4000 | max_wait=300
[2025-07-20 13:40:12] OPERATION_SUCCESS: merge_lora_weights | iter=500 | status=merged
[2025-07-20 13:40:12] OPERATION_START: change_lr  | iter=500 | value=0.2 | trigger=Loss threshold | val_loss=7.4033 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:40:12] OPERATION_SUCCESS: change_lr | iter=500 | old=7.0 | new=1.4000000000000001
[2025-07-20 13:40:12] OPERATION_START: change_warmup_iters  | iter=500 | value=5 | trigger=Loss threshold | val_loss=7.4033 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:40:12] OPERATION_SUCCESS: change_warmup_iters | iter=500 | old=1.0 | new=5.0
[2025-07-20 13:40:12] OPERATION_START: reset_lr_schedule  | iter=500 | value=None | trigger=Loss threshold | val_loss=7.4033 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:40:12] OPERATION_SUCCESS: reset_lr_schedule | iter=500 | old=200 | new=500
[2025-07-20 13:40:12] OPERATION_START: decrease_vocab_lora_scaling pre resize | iter=500 | value=2 | trigger=Loss threshold | val_loss=7.4033 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:40:13] OPERATION_SUCCESS: decrease_vocab_lora_scaling | iter=500 | old_divisor=16 | new_divisor=8.0 | new_rank=96
[2025-07-20 13:40:22] OPERATION_REEVALUATION: decrease_vocab_lora_scaling | iter=500 | old_val_loss=7.4033 | new_val_loss=7.6984 | change=+0.2951
[2025-07-20 13:40:22] step 500: train loss 7.7489, val loss 7.6984
[2025-07-20 13:41:33] step 600: train loss 7.2890, val loss 7.2925
[2025-07-20 13:41:34] OPERATION_START: decrease_attn_lora_scaling pre resize2 | iter=600 | value=2 | trigger=Loss threshold | val_loss=7.2925 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:41:34] OPERATION_SUCCESS: decrease_attn_lora_scaling | iter=600 | old_divisor=16 | new_divisor=8.0 | new_rank=96
[2025-07-20 13:41:41] OPERATION_REEVALUATION: decrease_attn_lora_scaling | iter=600 | old_val_loss=7.2925 | new_val_loss=7.2832 | change=-0.0093
[2025-07-20 13:41:41] step 600: train loss 7.2601, val loss 7.2832
[2025-07-20 13:42:52] step 700: train loss 7.2044, val loss 7.1861
[2025-07-20 13:42:53] OPERATION_START: change_batch_size  | iter=700 | value=0.25 | trigger=Loss threshold | val_loss=7.1861 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:42:53] OPERATION_SUCCESS: change_batch_size | iter=700 | old=32 | new=8
[2025-07-20 13:42:53] OPERATION_START: change_grad_accum  | iter=700 | value=2.0 | trigger=Loss threshold | val_loss=7.1861 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:42:53] OPERATION_SUCCESS: change_grad_accum | iter=700 | old=2 | new=4
[2025-07-20 13:42:53] OPERATION_START: change_lr  | iter=700 | value=0.7 | trigger=Loss threshold | val_loss=7.1861 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:42:53] OPERATION_SUCCESS: change_lr | iter=700 | old=1.4000000000000001 | new=0.98
[2025-07-20 13:42:53] OPERATION_START: reset_lr_schedule  | iter=700 | value=None | trigger=Loss threshold | val_loss=7.1861 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:42:53] OPERATION_SUCCESS: reset_lr_schedule | iter=700 | old=500 | new=700
[2025-07-20 13:42:53] OPERATION_START: stack_layers first resize | iter=700 | value=2 | trigger=Loss threshold | val_loss=7.1861 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:42:53] OPERATION_SUCCESS: stack_layers | iter=700 | old_divisor=4 | new_divisor=2.0 | new_layers=6
[2025-07-20 13:43:06] OPERATION_REEVALUATION: stack_layers | iter=700 | old_val_loss=7.1861 | new_val_loss=7.7357 | change=+0.5496
[2025-07-20 13:43:06] step 700: train loss 7.7403, val loss 7.7357
[2025-07-20 13:44:08] step 800: train loss 7.3202, val loss 7.2248
[2025-07-20 13:44:48] step 900: train loss 7.2313, val loss 7.1474
[2025-07-20 13:45:28] step 1000: train loss 7.2770, val loss 7.2206
[2025-07-20 13:46:08] step 1100: train loss 7.0379, val loss 7.1647
[2025-07-20 13:46:48] step 1200: train loss 7.1033, val loss 7.1482
[2025-07-20 13:47:28] step 1300: train loss 7.0600, val loss 7.1592
[2025-07-20 13:48:08] step 1400: train loss 7.1257, val loss 7.0455
[2025-07-20 13:48:09] OPERATION_START: merge_lora_weights third burn | iter=1400 | value=None | trigger=Loss threshold | val_loss=7.0455 | trigger_loss=7.1000 | max_wait=700
[2025-07-20 13:48:09] OPERATION_SUCCESS: merge_lora_weights | iter=1400 | status=merged
[2025-07-20 13:48:09] OPERATION_START: change_batch_size  | iter=1400 | value=0.5 | trigger=Loss threshold | val_loss=7.0455 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:48:09] OPERATION_SUCCESS: change_batch_size | iter=1400 | old=8 | new=4
[2025-07-20 13:48:09] OPERATION_START: change_grad_accum  | iter=1400 | value=2.0 | trigger=Loss threshold | val_loss=7.0455 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:48:09] OPERATION_SUCCESS: change_grad_accum | iter=1400 | old=4 | new=8
[2025-07-20 13:48:09] OPERATION_START: widen_mlp  | iter=1400 | value=2 | trigger=Loss threshold | val_loss=7.0455 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:48:10] OPERATION_SUCCESS: widen_mlp | iter=1400 | old_divisor=4 | new_divisor=2.0 | new_hidden=1536
[2025-07-20 13:48:22] OPERATION_REEVALUATION: widen_mlp | iter=1400 | old_val_loss=7.0455 | new_val_loss=7.0887 | change=+0.0432
[2025-07-20 13:48:22] step 1400: train loss 6.9469, val loss 7.0887
[2025-07-20 13:49:27] step 1500: train loss 7.1014, val loss 7.1555
[2025-07-20 13:49:28] OPERATION_START: change_lr  | iter=1500 | value=0.7 | trigger=Loss threshold | val_loss=7.1555 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:49:28] OPERATION_SUCCESS: change_lr | iter=1500 | old=0.98 | new=0.6859999999999999
[2025-07-20 13:49:28] OPERATION_START: reset_lr_schedule  | iter=1500 | value=None | trigger=Loss threshold | val_loss=7.1555 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:49:28] OPERATION_SUCCESS: reset_lr_schedule | iter=1500 | old=700 | new=1500
[2025-07-20 13:49:28] OPERATION_START: stack_layers third resize | iter=1500 | value=2 | trigger=Loss threshold | val_loss=7.1555 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:49:28] OPERATION_SUCCESS: stack_layers | iter=1500 | old_divisor=2.0 | new_divisor=1.0 | new_layers=12
[2025-07-20 13:49:49] OPERATION_REEVALUATION: stack_layers | iter=1500 | old_val_loss=7.1555 | new_val_loss=7.2535 | change=+0.0980
[2025-07-20 13:49:49] step 1500: train loss 7.3622, val loss 7.2535
[2025-07-20 13:51:36] step 1600: train loss 7.1218, val loss 7.1769
[2025-07-20 13:52:45] step 1700: train loss 6.9717, val loss 6.9181
[2025-07-20 13:53:55] step 1800: train loss 7.0894, val loss 7.0587
[2025-07-20 13:55:04] step 1900: train loss 7.1112, val loss 7.0786
[2025-07-20 13:56:13] step 2000: train loss 6.9042, val loss 6.9347
[2025-07-20 13:57:22] step 2100: train loss 6.8672, val loss 6.8780
[2025-07-20 13:57:25] OPERATION_START: merge_lora_weights fourth burn | iter=2100 | value=None | trigger=Timeout | val_loss=6.8780 | trigger_loss=6.0000 | max_wait=600
[2025-07-20 13:57:25] OPERATION_SUCCESS: merge_lora_weights | iter=2100 | status=merged
[2025-07-20 13:57:25] OPERATION_START: widen_mlp second resize | iter=2100 | value=2 | trigger=Loss threshold | val_loss=6.8780 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:57:26] OPERATION_SUCCESS: widen_mlp | iter=2100 | old_divisor=2.0 | new_divisor=1.0 | new_hidden=3072
[2025-07-20 13:57:49] OPERATION_REEVALUATION: widen_mlp | iter=2100 | old_val_loss=6.8780 | new_val_loss=6.9862 | change=+0.1083
[2025-07-20 13:57:49] step 2100: train loss 7.0060, val loss 6.9862
[2025-07-20 13:59:51] step 2200: train loss 6.8530, val loss 6.9993
[2025-07-20 13:59:55] OPERATION_START: change_batch_size  | iter=2200 | value=0.5 | trigger=Loss threshold | val_loss=6.9993 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:59:55] OPERATION_SUCCESS: change_batch_size | iter=2200 | old=4 | new=2
[2025-07-20 13:59:55] OPERATION_START: change_grad_accum  | iter=2200 | value=2.0 | trigger=Loss threshold | val_loss=6.9993 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:59:55] OPERATION_SUCCESS: change_grad_accum | iter=2200 | old=8 | new=16
[2025-07-20 13:59:55] OPERATION_START: stack_layers fourth resize | iter=2200 | value=2 | trigger=Loss threshold | val_loss=6.9993 | trigger_loss=100.0000 | max_wait=1
[2025-07-20 13:59:55] OPERATION_SUCCESS: stack_layers | iter=2200 | old_divisor=1.0 | new_divisor=0.5 | new_layers=24
[2025-07-20 14:00:36] OPERATION_REEVALUATION: stack_layers | iter=2200 | old_val_loss=6.9993 | new_val_loss=7.0290 | change=+0.0297
[2025-07-20 14:00:36] step 2200: train loss 6.9060, val loss 7.0290
